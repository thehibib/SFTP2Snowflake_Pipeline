import pysftp
import zipfile
import os
from datetime import datetime, timedelta

# variables (TODO: move to secrets manager)
hostN = 'hostname'
userN = 'username'
pswd = 'password'
datted = False
important_files = []
file_paths = []
dayago = datetime.now() - timedelta(hours=36000)
day_unix = int(dayago.timestamp())
print(day_unix)


#Cleaning up the directory
print("deleting files in storage directory")
for file in os.listdir('./WTIGFileStorage'):
    os.remove(f'./WTIGFileStorage/{file}')


# connect to sftp site
with pysftp.Connection(hostN, username=userN, password=pswd) as sftp:
    print("connected to sftp")
    for fname in sftp.listdir('./Outgoing'):
        path = f"./Outgoing/{fname}"
        fattribute = sftp.stat(path)
        time = fattribute.st_mtime
        if time >= day_unix:
            important_files.append(fname)
            file_paths.append(path)
    for file in file_paths:
        if "WHERE TO INVEST_DONE" in file:
            datted = True
            file_paths.remove(file)
    print(important_files)
    if datted == True:      
        for file in file_paths:
            if 'TAXASSESSOR' in file or 'PROPERTYDELETES' in file:
                with sftp.open(file, 'rb') as remote_file:
                    print('connected to file')
                    with open('dump.zip', 'wb') as local_file:
                        print("writing to zip:",file)
                        while True:
                            chunk = remote_file.read(10485760)  # Reading in chunks of 10MB
                            if not chunk:
                                break  # Exit loop when the file is fully read
                            local_file.write(chunk)
                try:
                    with zipfile.ZipFile('dump.zip', 'r') as zip_ref:
                        print("unzipping dump.zip")
                        zip_ref.extractall('./WTIGFileStorage')
                except Exception as e:
                    print("ERROR:", e)
    else:
        print("Could not find .dat within chosen files. Manually run/upload when complete")

# process files downloaded from sftp site
for file in os.listdir('./WTIGFileStorage'):
    if '.txt' in file:
        ogfile_name = str(file)
        print(ogfile_name)
        file_name = ogfile_name.split('INVEST_')
        file_name = file_name[1]
        print(file_name)
        file_name = file_name.split('.txt')
        file_name = file_name[0]
        os.rename(f'./WTIGFileStorage/{ogfile_name}',f'./WTIGFileStorage/{file_name}.csv')

# upload processed files to S3 bucket
print("moving files to s3")
import boto3
import os
import re
numbers = []
s3files = []
s3 = boto3.resource(
    service_name='s3',
    region_name='us-west-2',
    aws_access_key_id='s3_key',
    aws_secret_access_key='s3_secret'
)

for file in os.listdir('./WTIGFileStorage'):
    if '.csv' in file:
        s3.Bucket('bucket').upload_file(Filename=f'./WTIGFileStorage/{file}', Key=file)
        number = re.findall(r"\d+", file)
        number = ''.join(map(str, number))
        if number not in numbers:
            numbers.append(int(number))
        s3files.append(file)
        
numbers.sort()
print(numbers)

print("running snowflake commands")
import snowflake.connector

#numbers = [343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358]

# upload data to Snowflake and merge. TODO: move to secrets manager.
with snowflake.connector.connect(user='user',password='password',account='account', warehouse='compute_wh',database='db',schema='schema') as con:
    for num in numbers:
        print(num)
        cur = con.cursor()
        #tax assessor
        cur.execute('truncate table wti.attom.tax_assessor_upserts')
        cur.execute(f"""
        COPY INTO wti.attom.tax_assessor_upserts FROM @attom_s3_header_stage/TAXASSESSOR_0{num}.csv
            on_error=CONTINUE
        """)

        #property deletes
        cur.execute('truncate table wti.attom.property_deletes')
        cur.execute(f"""
        COPY INTO wti.attom.property_deletes FROM @attom_s3_header_stage/PROPERTYDELETES_0{num}.csv
            on_error=CONTINUE
        """)

        #merge
        cur.execute("""
        merge into WTI.ATTOM.tax_assessor as DBT_INTERNAL_DEST
        using WTI.ATTOM.tax_assessor_upserts as t on (t.ATTOMID = DBT_INTERNAL_DEST.ATTOMID)
        
        when matched then update set
        ATTOMID = t.ATTOMID,SITUSSTATECODE = t.SITUSSTATECODE,SITUSCOUNTY = t.SITUSCOUNTY,PROPERTYJURISDICTIONNAME = t.PROPERTYJURISDICTIONNAME,SITUSSTATECOUNTYFIPS = t.SITUSSTATECOUNTYFIPS,COMBINEDSTATISTICALAREA = t.COMBINEDSTATISTICALAREA,CBSANAME = t.CBSANAME,CBSACODE = t.CBSACODE,MSANAME = t.MSANAME,MSACODE = t.MSACODE,METROPOLITANDIVISION = t.METROPOLITANDIVISION,MINORCIVILDIVISIONNAME = t.MINORCIVILDIVISIONNAME,MINORCIVILDIVISIONCODE = t.MINORCIVILDIVISIONCODE,NEIGHBORHOODCODE = t.NEIGHBORHOODCODE,CENSUSFIPSPLACECODE = t.CENSUSFIPSPLACECODE,CENSUSTRACT = t.CENSUSTRACT,CENSUSBLOCKGROUP = t.CENSUSBLOCKGROUP,CENSUSBLOCK = t.CENSUSBLOCK,PARCELNUMBERRAW = t.PARCELNUMBERRAW,PARCELNUMBERFORMATTED = t.PARCELNUMBERFORMATTED,PARCELNUMBERYEARADDED = t.PARCELNUMBERYEARADDED,PARCELNUMBERALTERNATE = t.PARCELNUMBERALTERNATE,PARCELMAPBOOK = t.PARCELMAPBOOK,PARCELMAPPAGE = t.PARCELMAPPAGE,PARCELNUMBERYEARCHANGE = t.PARCELNUMBERYEARCHANGE,PARCELNUMBERPREVIOUS = t.PARCELNUMBERPREVIOUS,PARCELACCOUNTNUMBER = t.PARCELACCOUNTNUMBER,PROPERTYADDRESSFULL = t.PROPERTYADDRESSFULL,PROPERTYADDRESSHOUSENUMBER = t.PROPERTYADDRESSHOUSENUMBER,PROPERTYADDRESSSTREETDIRECTION = t.PROPERTYADDRESSSTREETDIRECTION,PROPERTYADDRESSSTREETNAME = t.PROPERTYADDRESSSTREETNAME,PROPERTYADDRESSSTREETSUFFIX = t.PROPERTYADDRESSSTREETSUFFIX,PROPERTYADDRESSSTREETPOSTDIRECTION = t.PROPERTYADDRESSSTREETPOSTDIRECTION,PROPERTYADDRESSUNITPREFIX = t.PROPERTYADDRESSUNITPREFIX,PROPERTYADDRESSUNITVALUE = t.PROPERTYADDRESSUNITVALUE,PROPERTYADDRESSCITY = t.PROPERTYADDRESSCITY,PROPERTYADDRESSSTATE = t.PROPERTYADDRESSSTATE,PROPERTYADDRESSZIP = t.PROPERTYADDRESSZIP,PROPERTYADDRESSZIP4 = t.PROPERTYADDRESSZIP4,PROPERTYADDRESSCRRT = t.PROPERTYADDRESSCRRT,PROPERTYADDRESSINFOPRIVACY = t.PROPERTYADDRESSINFOPRIVACY,CONGRESSIONALDISTRICTHOUSE = t.CONGRESSIONALDISTRICTHOUSE,PROPERTYLATITUDE = t.PROPERTYLATITUDE,PROPERTYLONGITUDE = t.PROPERTYLONGITUDE,GEOQUALITY = t.GEOQUALITY,LEGALDESCRIPTION = t.LEGALDESCRIPTION,LEGALRANGE = t.LEGALRANGE,LEGALTOWNSHIP = t.LEGALTOWNSHIP,LEGALSECTION = t.LEGALSECTION,LEGALQUARTER = t.LEGALQUARTER,LEGALQUARTERQUARTER = t.LEGALQUARTERQUARTER,LEGALSUBDIVISION = t.LEGALSUBDIVISION,LEGALPHASE = t.LEGALPHASE,LEGALTRACTNUMBER = t.LEGALTRACTNUMBER,LEGALBLOCK1 = t.LEGALBLOCK1,LEGALBLOCK2 = t.LEGALBLOCK2,LEGALLOTNUMBER1 = t.LEGALLOTNUMBER1,LEGALLOTNUMBER2 = t.LEGALLOTNUMBER2,LEGALLOTNUMBER3 = t.LEGALLOTNUMBER3,LEGALUNIT = t.LEGALUNIT,PARTYOWNER1NAMEFULL = t.PARTYOWNER1NAMEFULL,PARTYOWNER1NAMEFIRST = t.PARTYOWNER1NAMEFIRST,PARTYOWNER1NAMEMIDDLE = t.PARTYOWNER1NAMEMIDDLE,PARTYOWNER1NAMELAST = t.PARTYOWNER1NAMELAST,PARTYOWNER1NAMESUFFIX = t.PARTYOWNER1NAMESUFFIX,TRUSTDESCRIPTION = t.TRUSTDESCRIPTION,COMPANYFLAG = t.COMPANYFLAG,PARTYOWNER2NAMEFULL = t.PARTYOWNER2NAMEFULL,PARTYOWNER2NAMEFIRST = t.PARTYOWNER2NAMEFIRST,PARTYOWNER2NAMEMIDDLE = t.PARTYOWNER2NAMEMIDDLE,PARTYOWNER2NAMELAST = t.PARTYOWNER2NAMELAST,PARTYOWNER2NAMESUFFIX = t.PARTYOWNER2NAMESUFFIX,OWNERTYPEDESCRIPTION1 = t.OWNERTYPEDESCRIPTION1,OWNERSHIPVESTINGRELATIONCODE = t.OWNERSHIPVESTINGRELATIONCODE,PARTYOWNER3NAMEFULL = t.PARTYOWNER3NAMEFULL,PARTYOWNER3NAMEFIRST = t.PARTYOWNER3NAMEFIRST,PARTYOWNER3NAMEMIDDLE = t.PARTYOWNER3NAMEMIDDLE,PARTYOWNER3NAMELAST = t.PARTYOWNER3NAMELAST,PARTYOWNER3NAMESUFFIX = t.PARTYOWNER3NAMESUFFIX,PARTYOWNER4NAMEFULL = t.PARTYOWNER4NAMEFULL,PARTYOWNER4NAMEFIRST = t.PARTYOWNER4NAMEFIRST,PARTYOWNER4NAMEMIDDLE = t.PARTYOWNER4NAMEMIDDLE,PARTYOWNER4NAMELAST = t.PARTYOWNER4NAMELAST,PARTYOWNER4NAMESUFFIX = t.PARTYOWNER4NAMESUFFIX,OWNERTYPEDESCRIPTION2 = t.OWNERTYPEDESCRIPTION2,CONTACTOWNERMAILINGCOUNTY = t.CONTACTOWNERMAILINGCOUNTY,CONTACTOWNERMAILINGFIPS = t.CONTACTOWNERMAILINGFIPS,CONTACTOWNERMAILADDRESSFULL = t.CONTACTOWNERMAILADDRESSFULL,CONTACTOWNERMAILADDRESSHOUSENUMBER = t.CONTACTOWNERMAILADDRESSHOUSENUMBER,CONTACTOWNERMAILADDRESSSTREETDIRECTION = t.CONTACTOWNERMAILADDRESSSTREETDIRECTION,CONTACTOWNERMAILADDRESSSTREETNAME = t.CONTACTOWNERMAILADDRESSSTREETNAME,CONTACTOWNERMAILADDRESSSTREETSUFFIX = t.CONTACTOWNERMAILADDRESSSTREETSUFFIX,CONTACTOWNERMAILADDRESSSTREETPOSTDIRECTION = t.CONTACTOWNERMAILADDRESSSTREETPOSTDIRECTION,CONTACTOWNERMAILADDRESSUNITPREFIX = t.CONTACTOWNERMAILADDRESSUNITPREFIX,CONTACTOWNERMAILADDRESSUNIT = t.CONTACTOWNERMAILADDRESSUNIT,CONTACTOWNERMAILADDRESSCITY = t.CONTACTOWNERMAILADDRESSCITY,CONTACTOWNERMAILADDRESSSTATE = t.CONTACTOWNERMAILADDRESSSTATE,CONTACTOWNERMAILADDRESSZIP = t.CONTACTOWNERMAILADDRESSZIP,CONTACTOWNERMAILADDRESSZIP4 = t.CONTACTOWNERMAILADDRESSZIP4,CONTACTOWNERMAILADDRESSCRRT = t.CONTACTOWNERMAILADDRESSCRRT,CONTACTOWNERMAILADDRESSINFOFORMAT = t.CONTACTOWNERMAILADDRESSINFOFORMAT,CONTACTOWNERMAILINFOPRIVACY = t.CONTACTOWNERMAILINFOPRIVACY,STATUSOWNEROCCUPIEDFLAG = t.STATUSOWNEROCCUPIEDFLAG,DEEDOWNER1NAMEFULL = t.DEEDOWNER1NAMEFULL,DEEDOWNER1NAMEFIRST = t.DEEDOWNER1NAMEFIRST,DEEDOWNER1NAMEMIDDLE = t.DEEDOWNER1NAMEMIDDLE,DEEDOWNER1NAMELAST = t.DEEDOWNER1NAMELAST,DEEDOWNER1NAMESUFFIX = t.DEEDOWNER1NAMESUFFIX,DEEDOWNER2NAMEFULL = t.DEEDOWNER2NAMEFULL,DEEDOWNER2NAMEFIRST = t.DEEDOWNER2NAMEFIRST,DEEDOWNER2NAMEMIDDLE = t.DEEDOWNER2NAMEMIDDLE,DEEDOWNER2NAMELAST = t.DEEDOWNER2NAMELAST,DEEDOWNER2NAMESUFFIX = t.DEEDOWNER2NAMESUFFIX,DEEDOWNER3NAMEFULL = t.DEEDOWNER3NAMEFULL,DEEDOWNER3NAMEFIRST = t.DEEDOWNER3NAMEFIRST,DEEDOWNER3NAMEMIDDLE = t.DEEDOWNER3NAMEMIDDLE,DEEDOWNER3NAMELAST = t.DEEDOWNER3NAMELAST,DEEDOWNER3NAMESUFFIX = t.DEEDOWNER3NAMESUFFIX,DEEDOWNER4NAMEFULL = t.DEEDOWNER4NAMEFULL,DEEDOWNER4NAMEFIRST = t.DEEDOWNER4NAMEFIRST,DEEDOWNER4NAMEMIDDLE = t.DEEDOWNER4NAMEMIDDLE,DEEDOWNER4NAMELAST = t.DEEDOWNER4NAMELAST,DEEDOWNER4NAMESUFFIX = t.DEEDOWNER4NAMESUFFIX,TAXYEARASSESSED = t.TAXYEARASSESSED,TAXASSESSEDVALUETOTAL = t.TAXASSESSEDVALUETOTAL,TAXASSESSEDVALUEIMPROVEMENTS = t.TAXASSESSEDVALUEIMPROVEMENTS,TAXASSESSEDVALUELAND = t.TAXASSESSEDVALUELAND,TAXASSESSEDIMPROVEMENTSPERC = t.TAXASSESSEDIMPROVEMENTSPERC,PREVIOUSASSESSEDVALUE = t.PREVIOUSASSESSEDVALUE,TAXMARKETVALUEYEAR = t.TAXMARKETVALUEYEAR,TAXMARKETVALUETOTAL = t.TAXMARKETVALUETOTAL,TAXMARKETVALUEIMPROVEMENTS = t.TAXMARKETVALUEIMPROVEMENTS,TAXMARKETVALUELAND = t.TAXMARKETVALUELAND,TAXMARKETIMPROVEMENTSPERC = t.TAXMARKETIMPROVEMENTSPERC,TAXFISCALYEAR = t.TAXFISCALYEAR,TAXRATEAREA = t.TAXRATEAREA,TAXBILLEDAMOUNT = t.TAXBILLEDAMOUNT,TAXDELINQUENTYEAR = t.TAXDELINQUENTYEAR,LASTASSESSORTAXROLLUPDATE = t.LASTASSESSORTAXROLLUPDATE,ASSRLASTUPDATED = t.ASSRLASTUPDATED,TAXEXEMPTIONHOMEOWNERFLAG = t.TAXEXEMPTIONHOMEOWNERFLAG,TAXEXEMPTIONDISABLEDFLAG = t.TAXEXEMPTIONDISABLEDFLAG,TAXEXEMPTIONSENIORFLAG = t.TAXEXEMPTIONSENIORFLAG,TAXEXEMPTIONVETERANFLAG = t.TAXEXEMPTIONVETERANFLAG,TAXEXEMPTIONWIDOWFLAG = t.TAXEXEMPTIONWIDOWFLAG,TAXEXEMPTIONADDITIONAL = t.TAXEXEMPTIONADDITIONAL,YEARBUILT = t.YEARBUILT,YEARBUILTEFFECTIVE = t.YEARBUILTEFFECTIVE,ZONEDCODELOCAL = t.ZONEDCODELOCAL,PROPERTYUSEMUNI = t.PROPERTYUSEMUNI,PROPERTYUSEGROUP = t.PROPERTYUSEGROUP,PROPERTYUSESTANDARDIZED = t.PROPERTYUSESTANDARDIZED,ASSESSORLASTSALEDATE = t.ASSESSORLASTSALEDATE,ASSESSORLASTSALEAMOUNT = t.ASSESSORLASTSALEAMOUNT,ASSESSORPRIORSALEDATE = t.ASSESSORPRIORSALEDATE,ASSESSORPRIORSALEAMOUNT = t.ASSESSORPRIORSALEAMOUNT,LASTOWNERSHIPTRANSFERDATE = t.LASTOWNERSHIPTRANSFERDATE,LASTOWNERSHIPTRANSFERDOCUMENTNUMBER = t.LASTOWNERSHIPTRANSFERDOCUMENTNUMBER,LASTOWNERSHIPTRANSFERTRANSACTIONID = t.LASTOWNERSHIPTRANSFERTRANSACTIONID,DEEDLASTSALEDOCUMENTBOOK = t.DEEDLASTSALEDOCUMENTBOOK,DEEDLASTSALEDOCUMENTPAGE = t.DEEDLASTSALEDOCUMENTPAGE,DEEDLASTDOCUMENTNUMBER = t.DEEDLASTDOCUMENTNUMBER,DEEDLASTSALEDATE = t.DEEDLASTSALEDATE,DEEDLASTSALEPRICE = t.DEEDLASTSALEPRICE,DEEDLASTSALETRANSACTIONID = t.DEEDLASTSALETRANSACTIONID,AREABUILDING = t.AREABUILDING,AREABUILDINGDEFINITIONCODE = t.AREABUILDINGDEFINITIONCODE,AREAGROSS = t.AREAGROSS,AREA1STFLOOR = t.AREA1STFLOOR,AREA2NDFLOOR = t.AREA2NDFLOOR,AREAUPPERFLOORS = t.AREAUPPERFLOORS,AREALOTACRES = t.AREALOTACRES,AREALOTSF = t.AREALOTSF,AREALOTDEPTH = t.AREALOTDEPTH,AREALOTWIDTH = t.AREALOTWIDTH,ROOMSATTICAREA = t.ROOMSATTICAREA,ROOMSATTICFLAG = t.ROOMSATTICFLAG,ROOMSBASEMENTAREA = t.ROOMSBASEMENTAREA,ROOMSBASEMENTAREAFINISHED = t.ROOMSBASEMENTAREAFINISHED,ROOMSBASEMENTAREAUNFINISHED = t.ROOMSBASEMENTAREAUNFINISHED,PARKINGGARAGE = t.PARKINGGARAGE,PARKINGGARAGEAREA = t.PARKINGGARAGEAREA,PARKINGCARPORT = t.PARKINGCARPORT,PARKINGCARPORTAREA = t.PARKINGCARPORTAREA,HVACCOOLINGDETAIL = t.HVACCOOLINGDETAIL,HVACHEATINGDETAIL = t.HVACHEATINGDETAIL,HVACHEATINGFUEL = t.HVACHEATINGFUEL,UTILITIESSEWAGEUSAGE = t.UTILITIESSEWAGEUSAGE,UTILITIESWATERSOURCE = t.UTILITIESWATERSOURCE,UTILITIESMOBILEHOMEHOOKUPFLAG = t.UTILITIESMOBILEHOMEHOOKUPFLAG,FOUNDATION = t.FOUNDATION,CONSTRUCTION = t.CONSTRUCTION,INTERIORSTRUCTURE = t.INTERIORSTRUCTURE,PLUMBINGFIXTURESCOUNT = t.PLUMBINGFIXTURESCOUNT,CONSTRUCTIONFIRERESISTANCECLASS = t.CONSTRUCTIONFIRERESISTANCECLASS,SAFETYFIRESPRINKLERSFLAG = t.SAFETYFIRESPRINKLERSFLAG,FLOORINGMATERIALPRIMARY = t.FLOORINGMATERIALPRIMARY,BATHCOUNT = t.BATHCOUNT,BATHPARTIALCOUNT = t.BATHPARTIALCOUNT,BEDROOMSCOUNT = t.BEDROOMSCOUNT,ROOMSCOUNT = t.ROOMSCOUNT,STORIESCOUNT = t.STORIESCOUNT,UNITSCOUNT = t.UNITSCOUNT,ROOMSBONUSROOMFLAG = t.ROOMSBONUSROOMFLAG,ROOMSBREAKFASTNOOKFLAG = t.ROOMSBREAKFASTNOOKFLAG,ROOMSCELLARFLAG = t.ROOMSCELLARFLAG,ROOMSCELLARWINEFLAG = t.ROOMSCELLARWINEFLAG,ROOMSEXERCISEFLAG = t.ROOMSEXERCISEFLAG,ROOMSFAMILYCODE = t.ROOMSFAMILYCODE,ROOMSGAMEFLAG = t.ROOMSGAMEFLAG,ROOMSGREATFLAG = t.ROOMSGREATFLAG,ROOMSHOBBYFLAG = t.ROOMSHOBBYFLAG,ROOMSLAUNDRYFLAG = t.ROOMSLAUNDRYFLAG,ROOMSMEDIAFLAG = t.ROOMSMEDIAFLAG,ROOMSMUDFLAG = t.ROOMSMUDFLAG,ROOMSOFFICEAREA = t.ROOMSOFFICEAREA,ROOMSOFFICEFLAG = t.ROOMSOFFICEFLAG,ROOMSSAFEROOMFLAG = t.ROOMSSAFEROOMFLAG,ROOMSSITTINGFLAG = t.ROOMSSITTINGFLAG,ROOMSSTORMSHELTER = t.ROOMSSTORMSHELTER,ROOMSSTUDYFLAG = t.ROOMSSTUDYFLAG,ROOMSSUNROOMFLAG = t.ROOMSSUNROOMFLAG,ROOMSUTILITYAREA = t.ROOMSUTILITYAREA,ROOMSUTILITYCODE = t.ROOMSUTILITYCODE,FIREPLACE = t.FIREPLACE,FIREPLACECOUNT = t.FIREPLACECOUNT,ACCESSABILITYELEVATORFLAG = t.ACCESSABILITYELEVATORFLAG,ACCESSABILITYHANDICAPFLAG = t.ACCESSABILITYHANDICAPFLAG,ESCALATORFLAG = t.ESCALATORFLAG,CENTRALVACUUMFLAG = t.CENTRALVACUUMFLAG,CONTENTINTERCOMFLAG = t.CONTENTINTERCOMFLAG,CONTENTSOUNDSYSTEMFLAG = t.CONTENTSOUNDSYSTEMFLAG,WETBARFLAG = t.WETBARFLAG,SECURITYALARMFLAG = t.SECURITYALARMFLAG,STRUCTURESTYLE = t.STRUCTURESTYLE,EXTERIOR1CODE = t.EXTERIOR1CODE,ROOFMATERIAL = t.ROOFMATERIAL,ROOFCONSTRUCTION = t.ROOFCONSTRUCTION,CONTENTSTORMSHUTTERFLAG = t.CONTENTSTORMSHUTTERFLAG,CONTENTOVERHEADDOORFLAG = t.CONTENTOVERHEADDOORFLAG,VIEWDESCRIPTION = t.VIEWDESCRIPTION,PORCHCODE = t.PORCHCODE,PORCHAREA = t.PORCHAREA,PATIOAREA = t.PATIOAREA,DECKFLAG = t.DECKFLAG,DECKAREA = t.DECKAREA,FEATUREBALCONYFLAG = t.FEATUREBALCONYFLAG,BALCONYAREA = t.BALCONYAREA,BREEZEWAYFLAG = t.BREEZEWAYFLAG,PARKINGRVPARKINGFLAG = t.PARKINGRVPARKINGFLAG,PARKINGSPACECOUNT = t.PARKINGSPACECOUNT,DRIVEWAYAREA = t.DRIVEWAYAREA,DRIVEWAYMATERIAL = t.DRIVEWAYMATERIAL,POOL = t.POOL,POOLAREA = t.POOLAREA,CONTENTSAUNAFLAG = t.CONTENTSAUNAFLAG,TOPOGRAPHYCODE = t.TOPOGRAPHYCODE,FENCECODE = t.FENCECODE,FENCEAREA = t.FENCEAREA,COURTYARDFLAG = t.COURTYARDFLAG,COURTYARDAREA = t.COURTYARDAREA,ARBORPERGOLAFLAG = t.ARBORPERGOLAFLAG,SPRINKLERSFLAG = t.SPRINKLERSFLAG,GOLFCOURSEGREENFLAG = t.GOLFCOURSEGREENFLAG,TENNISCOURTFLAG = t.TENNISCOURTFLAG,SPORTSCOURTFLAG = t.SPORTSCOURTFLAG,ARENAFLAG = t.ARENAFLAG,WATERFEATUREFLAG = t.WATERFEATUREFLAG,PONDFLAG = t.PONDFLAG,BOATLIFTFLAG = t.BOATLIFTFLAG,BUILDINGSCOUNT = t.BUILDINGSCOUNT,BATHHOUSEAREA = t.BATHHOUSEAREA,BATHHOUSEFLAG = t.BATHHOUSEFLAG,BOATACCESSFLAG = t.BOATACCESSFLAG,BOATHOUSEAREA = t.BOATHOUSEAREA,BOATHOUSEFLAG = t.BOATHOUSEFLAG,CABINAREA = t.CABINAREA,CABINFLAG = t.CABINFLAG,CANOPYAREA = t.CANOPYAREA,CANOPYFLAG = t.CANOPYFLAG,GAZEBOAREA = t.GAZEBOAREA,GAZEBOFLAG = t.GAZEBOFLAG,GRAINERYAREA = t.GRAINERYAREA,GRAINERYFLAG = t.GRAINERYFLAG,GREENHOUSEAREA = t.GREENHOUSEAREA,GREENHOUSEFLAG = t.GREENHOUSEFLAG,GUESTHOUSEAREA = t.GUESTHOUSEAREA,GUESTHOUSEFLAG = t.GUESTHOUSEFLAG,KENNELAREA = t.KENNELAREA,KENNELFLAG = t.KENNELFLAG,LEANTOAREA = t.LEANTOAREA,LEANTOFLAG = t.LEANTOFLAG,LOADINGPLATFORMAREA = t.LOADINGPLATFORMAREA,LOADINGPLATFORMFLAG = t.LOADINGPLATFORMFLAG,MILKHOUSEAREA = t.MILKHOUSEAREA,MILKHOUSEFLAG = t.MILKHOUSEFLAG,OUTDOORKITCHENFIREPLACEFLAG = t.OUTDOORKITCHENFIREPLACEFLAG,POOLHOUSEAREA = t.POOLHOUSEAREA,POOLHOUSEFLAG = t.POOLHOUSEFLAG,POULTRYHOUSEAREA = t.POULTRYHOUSEAREA,POULTRYHOUSEFLAG = t.POULTRYHOUSEFLAG,QUONSETAREA = t.QUONSETAREA,QUONSETFLAG = t.QUONSETFLAG,SHEDAREA = t.SHEDAREA,SHEDCODE = t.SHEDCODE,SILOAREA = t.SILOAREA,SILOFLAG = t.SILOFLAG,STABLEAREA = t.STABLEAREA,STABLEFLAG = t.STABLEFLAG,STORAGEBUILDINGAREA = t.STORAGEBUILDINGAREA,STORAGEBUILDINGFLAG = t.STORAGEBUILDINGFLAG,UTILITYBUILDINGAREA = t.UTILITYBUILDINGAREA,UTILITYBUILDINGFLAG = t.UTILITYBUILDINGFLAG,POLESTRUCTUREAREA = t.POLESTRUCTUREAREA,POLESTRUCTUREFLAG = t.POLESTRUCTUREFLAG,COMMUNITYRECROOMFLAG = t.COMMUNITYRECROOMFLAG,PUBLICATIONDATE = t.PUBLICATIONDATE,PARCELSHELLRECORD = t.PARCELSHELLRECORD,ATTOMSTATUS = 'Active'
            
        when not matched then insert
        (ATTOMID, SITUSSTATECODE, SITUSCOUNTY, PROPERTYJURISDICTIONNAME, SITUSSTATECOUNTYFIPS, COMBINEDSTATISTICALAREA, CBSANAME, CBSACODE, MSANAME, MSACODE, METROPOLITANDIVISION, MINORCIVILDIVISIONNAME, MINORCIVILDIVISIONCODE, NEIGHBORHOODCODE, CENSUSFIPSPLACECODE, CENSUSTRACT, CENSUSBLOCKGROUP, CENSUSBLOCK, PARCELNUMBERRAW, PARCELNUMBERFORMATTED, PARCELNUMBERYEARADDED, PARCELNUMBERALTERNATE, PARCELMAPBOOK, PARCELMAPPAGE, PARCELNUMBERYEARCHANGE, PARCELNUMBERPREVIOUS, PARCELACCOUNTNUMBER, PROPERTYADDRESSFULL, PROPERTYADDRESSHOUSENUMBER, PROPERTYADDRESSSTREETDIRECTION, PROPERTYADDRESSSTREETNAME, PROPERTYADDRESSSTREETSUFFIX, PROPERTYADDRESSSTREETPOSTDIRECTION, PROPERTYADDRESSUNITPREFIX, PROPERTYADDRESSUNITVALUE, PROPERTYADDRESSCITY, PROPERTYADDRESSSTATE, PROPERTYADDRESSZIP, PROPERTYADDRESSZIP4, PROPERTYADDRESSCRRT, PROPERTYADDRESSINFOPRIVACY, CONGRESSIONALDISTRICTHOUSE, PROPERTYLATITUDE, PROPERTYLONGITUDE, GEOQUALITY, LEGALDESCRIPTION, LEGALRANGE, LEGALTOWNSHIP, LEGALSECTION, LEGALQUARTER, LEGALQUARTERQUARTER, LEGALSUBDIVISION, LEGALPHASE, LEGALTRACTNUMBER, LEGALBLOCK1, LEGALBLOCK2, LEGALLOTNUMBER1, LEGALLOTNUMBER2, LEGALLOTNUMBER3, LEGALUNIT, PARTYOWNER1NAMEFULL, PARTYOWNER1NAMEFIRST, PARTYOWNER1NAMEMIDDLE, PARTYOWNER1NAMELAST, PARTYOWNER1NAMESUFFIX, TRUSTDESCRIPTION, COMPANYFLAG, PARTYOWNER2NAMEFULL, PARTYOWNER2NAMEFIRST, PARTYOWNER2NAMEMIDDLE, PARTYOWNER2NAMELAST, PARTYOWNER2NAMESUFFIX, OWNERTYPEDESCRIPTION1, OWNERSHIPVESTINGRELATIONCODE, PARTYOWNER3NAMEFULL, PARTYOWNER3NAMEFIRST, PARTYOWNER3NAMEMIDDLE, PARTYOWNER3NAMELAST, PARTYOWNER3NAMESUFFIX, PARTYOWNER4NAMEFULL, PARTYOWNER4NAMEFIRST, PARTYOWNER4NAMEMIDDLE, PARTYOWNER4NAMELAST, PARTYOWNER4NAMESUFFIX, OWNERTYPEDESCRIPTION2, CONTACTOWNERMAILINGCOUNTY, CONTACTOWNERMAILINGFIPS, CONTACTOWNERMAILADDRESSFULL, CONTACTOWNERMAILADDRESSHOUSENUMBER, CONTACTOWNERMAILADDRESSSTREETDIRECTION, CONTACTOWNERMAILADDRESSSTREETNAME, CONTACTOWNERMAILADDRESSSTREETSUFFIX, CONTACTOWNERMAILADDRESSSTREETPOSTDIRECTION, CONTACTOWNERMAILADDRESSUNITPREFIX, CONTACTOWNERMAILADDRESSUNIT, CONTACTOWNERMAILADDRESSCITY, CONTACTOWNERMAILADDRESSSTATE, CONTACTOWNERMAILADDRESSZIP, CONTACTOWNERMAILADDRESSZIP4, CONTACTOWNERMAILADDRESSCRRT, CONTACTOWNERMAILADDRESSINFOFORMAT, CONTACTOWNERMAILINFOPRIVACY, STATUSOWNEROCCUPIEDFLAG, DEEDOWNER1NAMEFULL, DEEDOWNER1NAMEFIRST, DEEDOWNER1NAMEMIDDLE, DEEDOWNER1NAMELAST, DEEDOWNER1NAMESUFFIX, DEEDOWNER2NAMEFULL, DEEDOWNER2NAMEFIRST, DEEDOWNER2NAMEMIDDLE, DEEDOWNER2NAMELAST, DEEDOWNER2NAMESUFFIX, DEEDOWNER3NAMEFULL, DEEDOWNER3NAMEFIRST, DEEDOWNER3NAMEMIDDLE, DEEDOWNER3NAMELAST, DEEDOWNER3NAMESUFFIX, DEEDOWNER4NAMEFULL, DEEDOWNER4NAMEFIRST, DEEDOWNER4NAMEMIDDLE, DEEDOWNER4NAMELAST, DEEDOWNER4NAMESUFFIX, TAXYEARASSESSED, TAXASSESSEDVALUETOTAL, TAXASSESSEDVALUEIMPROVEMENTS, TAXASSESSEDVALUELAND, TAXASSESSEDIMPROVEMENTSPERC, PREVIOUSASSESSEDVALUE, TAXMARKETVALUEYEAR, TAXMARKETVALUETOTAL, TAXMARKETVALUEIMPROVEMENTS, TAXMARKETVALUELAND, TAXMARKETIMPROVEMENTSPERC, TAXFISCALYEAR, TAXRATEAREA, TAXBILLEDAMOUNT, TAXDELINQUENTYEAR, LASTASSESSORTAXROLLUPDATE, ASSRLASTUPDATED, TAXEXEMPTIONHOMEOWNERFLAG, TAXEXEMPTIONDISABLEDFLAG, TAXEXEMPTIONSENIORFLAG, TAXEXEMPTIONVETERANFLAG, TAXEXEMPTIONWIDOWFLAG, TAXEXEMPTIONADDITIONAL, YEARBUILT, YEARBUILTEFFECTIVE, ZONEDCODELOCAL, PROPERTYUSEMUNI, PROPERTYUSEGROUP, PROPERTYUSESTANDARDIZED, ASSESSORLASTSALEDATE, ASSESSORLASTSALEAMOUNT, ASSESSORPRIORSALEDATE, ASSESSORPRIORSALEAMOUNT, LASTOWNERSHIPTRANSFERDATE, LASTOWNERSHIPTRANSFERDOCUMENTNUMBER, LASTOWNERSHIPTRANSFERTRANSACTIONID, DEEDLASTSALEDOCUMENTBOOK, DEEDLASTSALEDOCUMENTPAGE, DEEDLASTDOCUMENTNUMBER, DEEDLASTSALEDATE, DEEDLASTSALEPRICE, DEEDLASTSALETRANSACTIONID, AREABUILDING, AREABUILDINGDEFINITIONCODE, AREAGROSS, AREA1STFLOOR, AREA2NDFLOOR, AREAUPPERFLOORS, AREALOTACRES, AREALOTSF, AREALOTDEPTH, AREALOTWIDTH, ROOMSATTICAREA, ROOMSATTICFLAG, ROOMSBASEMENTAREA, ROOMSBASEMENTAREAFINISHED, ROOMSBASEMENTAREAUNFINISHED, PARKINGGARAGE, PARKINGGARAGEAREA, PARKINGCARPORT, PARKINGCARPORTAREA, HVACCOOLINGDETAIL, HVACHEATINGDETAIL, HVACHEATINGFUEL, UTILITIESSEWAGEUSAGE, UTILITIESWATERSOURCE, UTILITIESMOBILEHOMEHOOKUPFLAG, FOUNDATION, CONSTRUCTION, INTERIORSTRUCTURE, PLUMBINGFIXTURESCOUNT, CONSTRUCTIONFIRERESISTANCECLASS, SAFETYFIRESPRINKLERSFLAG, FLOORINGMATERIALPRIMARY, BATHCOUNT, BATHPARTIALCOUNT, BEDROOMSCOUNT, ROOMSCOUNT, STORIESCOUNT, UNITSCOUNT, ROOMSBONUSROOMFLAG, ROOMSBREAKFASTNOOKFLAG, ROOMSCELLARFLAG, ROOMSCELLARWINEFLAG, ROOMSEXERCISEFLAG, ROOMSFAMILYCODE, ROOMSGAMEFLAG, ROOMSGREATFLAG, ROOMSHOBBYFLAG, ROOMSLAUNDRYFLAG, ROOMSMEDIAFLAG, ROOMSMUDFLAG, ROOMSOFFICEAREA, ROOMSOFFICEFLAG, ROOMSSAFEROOMFLAG, ROOMSSITTINGFLAG, ROOMSSTORMSHELTER, ROOMSSTUDYFLAG, ROOMSSUNROOMFLAG, ROOMSUTILITYAREA, ROOMSUTILITYCODE, FIREPLACE, FIREPLACECOUNT, ACCESSABILITYELEVATORFLAG, ACCESSABILITYHANDICAPFLAG, ESCALATORFLAG, CENTRALVACUUMFLAG, CONTENTINTERCOMFLAG, CONTENTSOUNDSYSTEMFLAG, WETBARFLAG, SECURITYALARMFLAG, STRUCTURESTYLE, EXTERIOR1CODE, ROOFMATERIAL, ROOFCONSTRUCTION, CONTENTSTORMSHUTTERFLAG, CONTENTOVERHEADDOORFLAG, VIEWDESCRIPTION, PORCHCODE, PORCHAREA, PATIOAREA, DECKFLAG, DECKAREA, FEATUREBALCONYFLAG, BALCONYAREA, BREEZEWAYFLAG, PARKINGRVPARKINGFLAG, PARKINGSPACECOUNT, DRIVEWAYAREA, DRIVEWAYMATERIAL, POOL, POOLAREA, CONTENTSAUNAFLAG, TOPOGRAPHYCODE, FENCECODE, FENCEAREA, COURTYARDFLAG, COURTYARDAREA, ARBORPERGOLAFLAG, SPRINKLERSFLAG, GOLFCOURSEGREENFLAG, TENNISCOURTFLAG, SPORTSCOURTFLAG, ARENAFLAG, WATERFEATUREFLAG, PONDFLAG, BOATLIFTFLAG, BUILDINGSCOUNT, BATHHOUSEAREA, BATHHOUSEFLAG, BOATACCESSFLAG, BOATHOUSEAREA, BOATHOUSEFLAG, CABINAREA, CABINFLAG, CANOPYAREA, CANOPYFLAG, GAZEBOAREA, GAZEBOFLAG, GRAINERYAREA, GRAINERYFLAG, GREENHOUSEAREA, GREENHOUSEFLAG, GUESTHOUSEAREA, GUESTHOUSEFLAG, KENNELAREA, KENNELFLAG, LEANTOAREA, LEANTOFLAG, LOADINGPLATFORMAREA, LOADINGPLATFORMFLAG, MILKHOUSEAREA, MILKHOUSEFLAG, OUTDOORKITCHENFIREPLACEFLAG, POOLHOUSEAREA, POOLHOUSEFLAG, POULTRYHOUSEAREA, POULTRYHOUSEFLAG, QUONSETAREA, QUONSETFLAG, SHEDAREA, SHEDCODE, SILOAREA, SILOFLAG, STABLEAREA, STABLEFLAG, STORAGEBUILDINGAREA, STORAGEBUILDINGFLAG, UTILITYBUILDINGAREA, UTILITYBUILDINGFLAG, POLESTRUCTUREAREA, POLESTRUCTUREFLAG, COMMUNITYRECROOMFLAG, PUBLICATIONDATE, PARCELSHELLRECORD, ATTOMSTATUS)
        values
        (ATTOMID, SITUSSTATECODE, SITUSCOUNTY, PROPERTYJURISDICTIONNAME, SITUSSTATECOUNTYFIPS, COMBINEDSTATISTICALAREA, CBSANAME, CBSACODE, MSANAME, MSACODE, METROPOLITANDIVISION, MINORCIVILDIVISIONNAME, MINORCIVILDIVISIONCODE, NEIGHBORHOODCODE, CENSUSFIPSPLACECODE, CENSUSTRACT, CENSUSBLOCKGROUP, CENSUSBLOCK, PARCELNUMBERRAW, PARCELNUMBERFORMATTED, PARCELNUMBERYEARADDED, PARCELNUMBERALTERNATE, PARCELMAPBOOK, PARCELMAPPAGE, PARCELNUMBERYEARCHANGE, PARCELNUMBERPREVIOUS, PARCELACCOUNTNUMBER, PROPERTYADDRESSFULL, PROPERTYADDRESSHOUSENUMBER, PROPERTYADDRESSSTREETDIRECTION, PROPERTYADDRESSSTREETNAME, PROPERTYADDRESSSTREETSUFFIX, PROPERTYADDRESSSTREETPOSTDIRECTION, PROPERTYADDRESSUNITPREFIX, PROPERTYADDRESSUNITVALUE, PROPERTYADDRESSCITY, PROPERTYADDRESSSTATE, PROPERTYADDRESSZIP, PROPERTYADDRESSZIP4, PROPERTYADDRESSCRRT, PROPERTYADDRESSINFOPRIVACY, CONGRESSIONALDISTRICTHOUSE, PROPERTYLATITUDE, PROPERTYLONGITUDE, GEOQUALITY, LEGALDESCRIPTION, LEGALRANGE, LEGALTOWNSHIP, LEGALSECTION, LEGALQUARTER, LEGALQUARTERQUARTER, LEGALSUBDIVISION, LEGALPHASE, LEGALTRACTNUMBER, LEGALBLOCK1, LEGALBLOCK2, LEGALLOTNUMBER1, LEGALLOTNUMBER2, LEGALLOTNUMBER3, LEGALUNIT, PARTYOWNER1NAMEFULL, PARTYOWNER1NAMEFIRST, PARTYOWNER1NAMEMIDDLE, PARTYOWNER1NAMELAST, PARTYOWNER1NAMESUFFIX, TRUSTDESCRIPTION, COMPANYFLAG, PARTYOWNER2NAMEFULL, PARTYOWNER2NAMEFIRST, PARTYOWNER2NAMEMIDDLE, PARTYOWNER2NAMELAST, PARTYOWNER2NAMESUFFIX, OWNERTYPEDESCRIPTION1, OWNERSHIPVESTINGRELATIONCODE, PARTYOWNER3NAMEFULL, PARTYOWNER3NAMEFIRST, PARTYOWNER3NAMEMIDDLE, PARTYOWNER3NAMELAST, PARTYOWNER3NAMESUFFIX, PARTYOWNER4NAMEFULL, PARTYOWNER4NAMEFIRST, PARTYOWNER4NAMEMIDDLE, PARTYOWNER4NAMELAST, PARTYOWNER4NAMESUFFIX, OWNERTYPEDESCRIPTION2, CONTACTOWNERMAILINGCOUNTY, CONTACTOWNERMAILINGFIPS, CONTACTOWNERMAILADDRESSFULL, CONTACTOWNERMAILADDRESSHOUSENUMBER, CONTACTOWNERMAILADDRESSSTREETDIRECTION, CONTACTOWNERMAILADDRESSSTREETNAME, CONTACTOWNERMAILADDRESSSTREETSUFFIX, CONTACTOWNERMAILADDRESSSTREETPOSTDIRECTION, CONTACTOWNERMAILADDRESSUNITPREFIX, CONTACTOWNERMAILADDRESSUNIT, CONTACTOWNERMAILADDRESSCITY, CONTACTOWNERMAILADDRESSSTATE, CONTACTOWNERMAILADDRESSZIP, CONTACTOWNERMAILADDRESSZIP4, CONTACTOWNERMAILADDRESSCRRT, CONTACTOWNERMAILADDRESSINFOFORMAT, CONTACTOWNERMAILINFOPRIVACY, STATUSOWNEROCCUPIEDFLAG, DEEDOWNER1NAMEFULL, DEEDOWNER1NAMEFIRST, DEEDOWNER1NAMEMIDDLE, DEEDOWNER1NAMELAST, DEEDOWNER1NAMESUFFIX, DEEDOWNER2NAMEFULL, DEEDOWNER2NAMEFIRST, DEEDOWNER2NAMEMIDDLE, DEEDOWNER2NAMELAST, DEEDOWNER2NAMESUFFIX, DEEDOWNER3NAMEFULL, DEEDOWNER3NAMEFIRST, DEEDOWNER3NAMEMIDDLE, DEEDOWNER3NAMELAST, DEEDOWNER3NAMESUFFIX, DEEDOWNER4NAMEFULL, DEEDOWNER4NAMEFIRST, DEEDOWNER4NAMEMIDDLE, DEEDOWNER4NAMELAST, DEEDOWNER4NAMESUFFIX, TAXYEARASSESSED, TAXASSESSEDVALUETOTAL, TAXASSESSEDVALUEIMPROVEMENTS, TAXASSESSEDVALUELAND, TAXASSESSEDIMPROVEMENTSPERC, PREVIOUSASSESSEDVALUE, TAXMARKETVALUEYEAR, TAXMARKETVALUETOTAL, TAXMARKETVALUEIMPROVEMENTS, TAXMARKETVALUELAND, TAXMARKETIMPROVEMENTSPERC, TAXFISCALYEAR, TAXRATEAREA, TAXBILLEDAMOUNT, TAXDELINQUENTYEAR, LASTASSESSORTAXROLLUPDATE, ASSRLASTUPDATED, TAXEXEMPTIONHOMEOWNERFLAG, TAXEXEMPTIONDISABLEDFLAG, TAXEXEMPTIONSENIORFLAG, TAXEXEMPTIONVETERANFLAG, TAXEXEMPTIONWIDOWFLAG, TAXEXEMPTIONADDITIONAL, YEARBUILT, YEARBUILTEFFECTIVE, ZONEDCODELOCAL, PROPERTYUSEMUNI, PROPERTYUSEGROUP, PROPERTYUSESTANDARDIZED, ASSESSORLASTSALEDATE, ASSESSORLASTSALEAMOUNT, ASSESSORPRIORSALEDATE, ASSESSORPRIORSALEAMOUNT, LASTOWNERSHIPTRANSFERDATE, LASTOWNERSHIPTRANSFERDOCUMENTNUMBER, LASTOWNERSHIPTRANSFERTRANSACTIONID, DEEDLASTSALEDOCUMENTBOOK, DEEDLASTSALEDOCUMENTPAGE, DEEDLASTDOCUMENTNUMBER, DEEDLASTSALEDATE, DEEDLASTSALEPRICE, DEEDLASTSALETRANSACTIONID, AREABUILDING, AREABUILDINGDEFINITIONCODE, AREAGROSS, AREA1STFLOOR, AREA2NDFLOOR, AREAUPPERFLOORS, AREALOTACRES, AREALOTSF, AREALOTDEPTH, AREALOTWIDTH, ROOMSATTICAREA, ROOMSATTICFLAG, ROOMSBASEMENTAREA, ROOMSBASEMENTAREAFINISHED, ROOMSBASEMENTAREAUNFINISHED, PARKINGGARAGE, PARKINGGARAGEAREA, PARKINGCARPORT, PARKINGCARPORTAREA, HVACCOOLINGDETAIL, HVACHEATINGDETAIL, HVACHEATINGFUEL, UTILITIESSEWAGEUSAGE, UTILITIESWATERSOURCE, UTILITIESMOBILEHOMEHOOKUPFLAG, FOUNDATION, CONSTRUCTION, INTERIORSTRUCTURE, PLUMBINGFIXTURESCOUNT, CONSTRUCTIONFIRERESISTANCECLASS, SAFETYFIRESPRINKLERSFLAG, FLOORINGMATERIALPRIMARY, BATHCOUNT, BATHPARTIALCOUNT, BEDROOMSCOUNT, ROOMSCOUNT, STORIESCOUNT, UNITSCOUNT, ROOMSBONUSROOMFLAG, ROOMSBREAKFASTNOOKFLAG, ROOMSCELLARFLAG, ROOMSCELLARWINEFLAG, ROOMSEXERCISEFLAG, ROOMSFAMILYCODE, ROOMSGAMEFLAG, ROOMSGREATFLAG, ROOMSHOBBYFLAG, ROOMSLAUNDRYFLAG, ROOMSMEDIAFLAG, ROOMSMUDFLAG, ROOMSOFFICEAREA, ROOMSOFFICEFLAG, ROOMSSAFEROOMFLAG, ROOMSSITTINGFLAG, ROOMSSTORMSHELTER, ROOMSSTUDYFLAG, ROOMSSUNROOMFLAG, ROOMSUTILITYAREA, ROOMSUTILITYCODE, FIREPLACE, FIREPLACECOUNT, ACCESSABILITYELEVATORFLAG, ACCESSABILITYHANDICAPFLAG, ESCALATORFLAG, CENTRALVACUUMFLAG, CONTENTINTERCOMFLAG, CONTENTSOUNDSYSTEMFLAG, WETBARFLAG, SECURITYALARMFLAG, STRUCTURESTYLE, EXTERIOR1CODE, ROOFMATERIAL, ROOFCONSTRUCTION, CONTENTSTORMSHUTTERFLAG, CONTENTOVERHEADDOORFLAG, VIEWDESCRIPTION, PORCHCODE, PORCHAREA, PATIOAREA, DECKFLAG, DECKAREA, FEATUREBALCONYFLAG, BALCONYAREA, BREEZEWAYFLAG, PARKINGRVPARKINGFLAG, PARKINGSPACECOUNT, DRIVEWAYAREA, DRIVEWAYMATERIAL, POOL, POOLAREA, CONTENTSAUNAFLAG, TOPOGRAPHYCODE, FENCECODE, FENCEAREA, COURTYARDFLAG, COURTYARDAREA, ARBORPERGOLAFLAG, SPRINKLERSFLAG, GOLFCOURSEGREENFLAG, TENNISCOURTFLAG, SPORTSCOURTFLAG, ARENAFLAG, WATERFEATUREFLAG, PONDFLAG, BOATLIFTFLAG, BUILDINGSCOUNT, BATHHOUSEAREA, BATHHOUSEFLAG, BOATACCESSFLAG, BOATHOUSEAREA, BOATHOUSEFLAG, CABINAREA, CABINFLAG, CANOPYAREA, CANOPYFLAG, GAZEBOAREA, GAZEBOFLAG, GRAINERYAREA, GRAINERYFLAG, GREENHOUSEAREA, GREENHOUSEFLAG, GUESTHOUSEAREA, GUESTHOUSEFLAG, KENNELAREA, KENNELFLAG, LEANTOAREA, LEANTOFLAG, LOADINGPLATFORMAREA, LOADINGPLATFORMFLAG, MILKHOUSEAREA, MILKHOUSEFLAG, OUTDOORKITCHENFIREPLACEFLAG, POOLHOUSEAREA, POOLHOUSEFLAG, POULTRYHOUSEAREA, POULTRYHOUSEFLAG, QUONSETAREA, QUONSETFLAG, SHEDAREA, SHEDCODE, SILOAREA, SILOFLAG, STABLEAREA, STABLEFLAG, STORAGEBUILDINGAREA, STORAGEBUILDINGFLAG, UTILITYBUILDINGAREA, UTILITYBUILDINGFLAG, POLESTRUCTUREAREA, POLESTRUCTUREFLAG, COMMUNITYRECROOMFLAG, PUBLICATIONDATE, PARCELSHELLRECORD, 'Active')
        """)

        cur.execute("update tax_assessor ta set attomstatus = 'Inactive' from property_deletes pd where ta.attomid = pd.attomid")

# cleanup files in S3
print("moving to s3 file deletion")
for file in s3files:
    s3.delete_object(Bucket='bucket', Key=file)
    print('deleted',file)
